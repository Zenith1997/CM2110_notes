# Statistical Distributions

```{r initial1, echo = FALSE, cache = FALSE, include = FALSE}
library(knitr)
opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  fig.path = 'figure/',
  cache.path = 'cache/',
  fig.align = 'center',
  fig.show = 'hold',
  cache = FALSE,
  external = TRUE,
  dev = "png",
  fig.height = 5,
  fig.width = 10
)


library(tidyverse)
library(ggpubr)

```

\pagenumbering{arabic}

## Recap: CM 1110-Probability {-}

### Axioms of probability {-}

```{r   out.width = "100%", echo = FALSE, fig.align='center'}
knitr::include_graphics("figure/Axioms.png")
```


- **Probability** of an event quantifies the **uncertainty**, randomness, or the possibility of occurrence the event. 
- The probability of event E is usually denoted by $P(E)$.
- Mathematically, the function $P(.)$ is a set function defined from sample space $(\Omega)$ to $[0, 1]$ interval, satisfying the following properties. 
- These are called the **'axioms of probability'**.

- **Axiom 1:** For any event $A$, $P(A) \geq 0$
- **Axiom 2:** $P(\Omega) = 1$
- **Axiom 3:** 
   - (a) If $A_1, A_2, \dots, A_k$ is a finite collection of mutually exclusive events, then \[P(A_1\cup A_2\cup \dots \cup A_k)= \sum_{i=1}^kP(A_i)\]
	   (b) If $A_1, A_2, \dots$ is an infinite collection of mutually exclusive events, then 
\[P(A_1\cup A_2\cup \dots)= \sum_{i=1}^\infty P(A_i)\]

**NOTE**

- Axioms 1 and 2 imply that for any event $E$, $0 \leq P (E) \leq 1$.
- $P (E) = 1 \iff$ the event E is certain to occur.
-	$P (E) = 1 \iff$ the event E cannot occur.

### Methods for determining Probability {-}

- There are several ways for determining the probability of events. 
- Usually we use the following methods to obtain the probability of events.
    - Classical method
    - Relative frequency method (Empirical approach)
    - Subjective method
    - **Using probability models**

\newpage

## Random Variable

-	Some sample spaces contain quantitative (numerical) outcomes, others contain qualitative outcomes.
-	Often it is convenient to work with sample spaces containing numerical outcomes.
-	A function that maps the original sample space into the real numbers is called a 'random variable'.
-	This is more useful when the original sample space contains qualitative outcomes.

**Definition 1: Random Variable**

Let $\Omega$ be a sample space. Let $X$ be a function from $\Omega$  to $\Re$ (*i.e.* $X:\Omega \rightarrow \Re$). Then $X$ is called a random variable.

<!--**random variable** is a function from a sample space $S$ into the real numbers (*i.e.* $X:S \rightarrow \Re$)-->

```{r   out.width = "50%", echo = FALSE, fig.align='center'}
knitr::include_graphics("figure/Ch1_F1.png")
```

- A random variable assigns a real number to each outcome of a sample space.
-	In other words, to each outcome of an experiment or a sample point $\omega_i$, of the sample spaces, there is a unique real number $x_i$, known as the value of the random variable $X$.
- The range of the random variable is called the *induced sample space*. 
- *A note on notation:* Random variables will always denoted with uppercase letters and the realized values of the random variable (or its range) will be denoted by the corresponding lowercase letters. Thus, the random variable $X$ can take the value $x$. 
- Each outcome of a sample space occurs with a certain probability. Therefore,  each possible value of a random variable is associated with a probability. 
- Any events of a sample space can be written in terms of a suitably defined random variable. 

### Types of Random Variables

- A random variable is of two types
  - Discrete Random Variable
  - Continuous Random Variable

#### Discrete Random Variable

- If the induced sample space is discrete, then the random variable is called a **discrete random variable**.
<!--- A random variable ($X$) is said to be discrete if it takes only a finite; or an infinite but countable number of values.-->
<!-- Examples: The following are discrete random variables:
  -	Number of children per family 
  -	Attendance of CM 2110 lectures
  -	GPA credit value that you can obtain for CM 2110
  -	The number of machine breakdowns during a given day in a company
-->

*Example 01*
Consider the experiment of tossing a coin.  Express the following events using a suitably defined random variable

$H=$ *The event of getting a head*

$T=$ *The event of getting a tail*

```{r Ch1box1, out.width='100%', fig.asp=.9, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

*Example 02*

Consider the experiment of rolling of a die.  Express the following events using a suitably defined random variable

$A=$ *The event that the number faced up is less than 5*

$B=$ *The event that the number faced up is even*

$C=$ *The event that the number faced up is is 2 or 5*

```{r Ch1box2, out.width='100%', fig.asp=.9, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

\newpage

*Example 03*

Consider the experiment of tossing a coin 10 times. Then the sample space $\Omega$ contains $2^{10} = 1024$ outcomes. Each outcome is a sequence of 10 H's and T's.

Express the following events in terms of a suitably defined random variable.

$D=$ *The event that the number of heads is 5*

$E=$ *The event that the number of tails is less than 4*

 
```{r Ch1box3, out.width='100%', fig.asp=.9, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

#### Continuous Random Variable

- If the induced sample space is continuous, then the random variable is called a **continuous random variable.**
<!--- A continuous random variable is a random variable that can take on any value in a given interval.
-	Random variables which consist of measurements are usually continuous. 
- For example
  -	height of a student in this class 
  -	the current measured in a thin copper wire in milliamperes
  -	Life time of a mobile phone battery
  -	SGPA of a level 2 student
-->

*Example 04*

Consider the experiment of measuring the lifetime (in hours) of a randomly selected bulb.  Express the following events in terms of a suitably defined random variable. 
 
$F=$ *The event that the lifetime is less than 300 hours*

$G=$ *The event that the lifetime is 1000 hours*

```{r Ch1box4, out.width='100%', fig.asp=.7, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```


## Probability Mass Function
\label{sec:pmf}

**Definition 2: Discrete density function of a discrete random variable**

If $X$ is a discrete random variable with distinct values $x_1, x_2, \dots, x_n, \dots,$ then the function, denoted by $f_X(.)$ and defined by

\begin{equation}
f_X(x) =
\begin{cases} 
P(X=x) & \text{if } x=x_j, j=1,2,\dots,n,\dots\\
0 & \text{if } x \neq x_j
\end{cases}
\end{equation}

is defined to be the discrete density function of $X$.


<!-- - The function that gives the probability of each possible value of a discrete random variable is called its probability mass function-->


- The values of a discrete random variable are often called *mass points.*
- $f_X(x)$ denotes the *mass* associated with the *mass point* $x_j$.
- ***Probability mass function*** *discrete frequency function* and *probability function* are other terms used in place of *discrete density function*
- Probability function gives the measure of probability for different values of $X$.

### Properties of a Probability Mass Function

- Let $X$ be a discrete random variable with probability mass function $f_X(x)$. Then,

1. For any $x\in \Re$, $0\leq f_X(x) \leq 1.$
2. Let $E$ be an event and $I= \{X(\omega):\omega \in E\}.$ Then $P(E) = P(X\in I) = \sum_{x \in I}f_X(x).$
3. Let $R = \{X(\omega):\omega \in \Omega\}.$ Then $\sum_{x\in \Re} f_X(x) = 1.$


### Representations of Probability Mass Functions

*Example 05*

Consider the experiment of tossing a fair coin.  Let 

\begin{equation}
X =
\begin{cases} 
0 & \text{if the outcome is a Tail }\\
0 & \text{if the outcome is a Head}
\end{cases}
\end{equation}

Find the probability mass function of $X$. Is $X$ discrete or continuous?

#### Using a table

```{r Ch1box5, out.width='100%', fig.asp=.9, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

#### Using a function

```{r Ch1box6, out.width='100%', fig.asp=.9, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

#### Using a graph

```{r Ch1box7, out.width='100%', fig.asp=.9, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

## Probability Density Function

- Let $X$ be a continuous random variable.

- Then, it is not possible to define a pmf $f_x$ with properties mentioned in Section \ref{sec:pmf}. **Why?**

- Instead, we can find a function $f_x$ with the some different properties.

- Probability density function (pdf) of a continuous random variable is a function that describes the relative likelihood for this random variable to occur at a given point.

### Properties of a Probability Density Function
\label{sec:pdfproperties}


Let $X$ be a continuous random variable with probability density function $f_x$. Then,

1. For any $x\in \Re$, $f_X(x) \geq0$.
2. Let $E$ be an event and $I= \{X(\omega):\omega \in E\}.$ Then $P(E) = P(X\in I) = \int_If_X(x)dx.$
3. Let $R = \{X(\omega):\omega \in \Omega\}.$ Then $\int_\Re f_X(x)dx= 1.$


### Existence of pdf

- To see the existence of such a function, consider a continuous random variable $X$,
- Suppose that we have a very large number of observations, $N$, of $X$, measured to high accuracy (large number of decimal places). 
- consider the following grouped frequency table and the histogram constructed from those data. 
- The height of the bar on a class interval of this histogram is equal to the relative frequency per unit in that class interval. 


Interval | Class boundaries | Class frequency | Height of the bar | Area of the bar
---------|-----------------|-----------------|-------------------| ---------------
$I_1$| $x_1 -\delta x/2, x_1+\delta x/2$ | $n_1$ | $\frac{n_1}{\delta x*N}$ |  $\frac{n1}{N}$
$I_2$| $x_2 -\delta x/2, x_2+\delta x/2$ | $n_2$ | $\frac{n_2}{\delta x*N}$ |  $\frac{n2}{N}$
$\vdots$| $\vdots$ |$\vdots$| $\vdots$| $\vdots$
$I_k$| $x_k -\delta x/2, x_k+\delta x/2$ | $n_k$ | $\frac{n_k}{\delta x*N}$ |  $\frac{nk}{N}$ 
  | Total|  |  | 


```{r hist, fig.cap="Histograms with different class intervals and a possible model for the pdf", fig.height=15, fig.width=25}
set.seed(123)
data <- data.frame(x= c(rnorm(10000,45,10), rnorm(20000,90,10))) 


p1 <- data %>%
  ggplot(aes(x, ..density..)) +
  geom_histogram(bins= 10)+
  geom_density(colour= "red", size= 2)+
  ggtitle("(a)") +
  ylab("Probability density")

p2 <- data %>%
  ggplot(aes(x, ..density..)) +
  geom_histogram(bins= 20)+
  geom_density(colour= "red",  size= 2)+
  ggtitle("(a)") +
  ylab("Probability density")

p3 <- data %>%
  ggplot(aes(x, ..density..)) +
  geom_histogram(bins=40)+
  geom_density(colour= "red",  size= 2)+
  ggtitle("(a)") +
  ylab("Probability density")

p4 <- data %>%
  ggplot(aes(x, ..density..)) +
  geom_histogram(bins= 100)+
  geom_density(colour= "red", size = 2)+
  ggtitle("(a)") +
  ylab("Probability density")

p<- ggarrange(ggarrange(p1,p2,ncol = 2) , ggarrange(p3,p4, ncol = 2), nrow= 2)
print(p)
```

- Then, for the $i^{th}$ interval, 

$$P(x_i - \frac{\delta x}{2} \leq X \leq x_i + \frac{\delta x}{2}) \approx \text{Area of the bar} $$
 and therefore
 
$$\text{Height of the bar} \approx \frac{\text{Area of the bar}}{\delta x} \approx \frac{ P(x_i - \frac{\delta x}{2} \leq X \leq x_i + \frac{\delta x}{2})}{\delta x}  $$

- Therefore, the height of a bar represents the *probability density* in that class interval.

- When $\delta x \rightarrow0$, it will allow us to approximate the histogram by a smooth curve as in Figure \ref{fig:hist} (d). 

- As the are under each histogram is 1, the area under the curve is also 1

- For any point $x$, 

$$\text{The height of the curve} \approx \lim \limits_{\delta x \to 0} \frac{P(x_i-\frac{\delta x}{2} \leq X \leq x_i+\frac{\delta x}{2})}{\delta x} $$

will represent the **the probability density at point** $x$. 

- Let the above smooth curve be denoted  by $f_X$.
- Then, $f_X$ has the properties mentioned in Section \ref{sec:pdfproperties}.
- The function is called the **probability density function of**
$X$.

- **NOTE** Here $f_X(x)$ represents **Probability density** *at point* $x$. Not *Probability at point* $x$.


<!--The shape of the density function $f_x$ of a continuous random variable $X$ is approximately the same as the smoothed histogram from a very large data set $X$-->


### Calculation of Probability using pdf

- Let $c,d \in \Re$ such that $c\leq d$. Then,

$$P(c\leq X \leq d) = \int_c^d f_X(x)dx$$

```{r hist2, fig.cap="Histograms with different class intervals and a possible model for the pdf"}
set.seed(123)
data <- data.frame(x= c(rnorm(10000,45,10), rnorm(20000,90,10))) 

dat <- with(density(data$x), data.frame(x, y))
p<- ggplot(data = dat, mapping = aes(x = x, y = y)) +
    geom_line()+
    geom_area(mapping = aes(x = ifelse(x>50 & x< 80 , x, 0)), fill = "darkblue") +
    xlim(2, 128)+
  ylab("f(x)")

print(p)
```


- **NOTE:** if $X$ is a continuous random variable with the p.d.f $f_X$, then for any $k \in \Re$,

$$P(X=k) = P(k\leq X\leq k)=\int_k^kf_X(x)dx = 0$$

- Therefore, for a continuous random variable $X$, 
$$P(c<X<d) = P(c\leq X<d) =  P(c < X\leq d)=  P(c \leq X\leq d)= \int_c^df_X(x)dx$$


## Cumulative Distribution Function

- There are many problems in which it is of interest to know the probability that the values of a random variable is less than or equal to some real number $x$.

**Definition 3: Cumulative distribution function**

The *cumulative distibution function* or $cdf$ of a random variable $X$, denoted by $F_X(x)$, is defined by 

$$F_x(x) = P(X\leq x), \text{ for all } x $$

- Therefore, if $X$ is a discrete random variable, the cdf is given by,

$$F_X(x)=\sum_{t\leq x}f_X(t), \text{ } -\infty < x<\infty$$

where $f_X(t)$ is the value of the pmf of $X$ at $t$.


### Relationship between cdf and pdf 

- If $X$ is a continuous random variable, the cdf is given by, 

$$F_X(x) = \int_{-\infty}^{x}f_X(t)dt \text{  } -\infty <x<\infty$$
where $f_X(t)$ is the value of the pdf of $X$ at $t$. (Here $t$ is a dummy integration variable).

- Conversely,

$$f_X(x)= \frac{dF_X(x)}{dx}$$

*Example 06*

An owner of a  software engineering company is interested in knowing how many years his employees stay with his company. Let $X$ be the number of years an employee will stay with the company. Over the years, he has established the following probability distribution:

\newpage

$x$	|1|	2|	3|	4|	5|	6|	7
--|---|---|---|---|---|---|---
 $f_X(x) = P(X=x)$|0.1	|0.05|	0.1|?|0.3|	0.2|	0.1

1. Find $f_X(4)$

```{r Ch1box8, out.width='100%', fig.asp=.5, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

2. Find $P(X<4)$

```{r Ch1box9, out.width='100%', fig.asp=.7, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

3. Find $P(X\leq4)$

```{r Ch1box10, out.width='100%', fig.asp=.7, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```

4. Draw the probability mass function of $X$

```{r Ch1box11, out.width='100%', fig.asp=.7, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```


5. Draw the cumulative distribution function of $X$

```{r Ch1box12, out.width='100%', fig.asp=.7, fig.align='center', fig.pos='h'}
library(ggplot2)

ggplot()+
  theme_void()+
  theme(panel.border = element_rect(colour = "white", fill=NA, size=1))

```


### Properties of a cumulative distribution function of a **Discrete random variable**



\newpage

## Descriptive properties of distributions

## Models for discrete distributions

## Models for continuous distributions
